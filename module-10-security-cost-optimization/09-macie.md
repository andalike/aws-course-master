# Amazon Macie

## Introduction

Amazon Macie is a fully managed data security and data privacy service that uses machine learning and pattern matching to discover and protect sensitive data in AWS. Macie automatically provides an inventory of S3 buckets and evaluates and monitors them for security and access control.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Amazon Macie Overview                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                         S3 Buckets                                   â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚   â”‚  â”‚ Bucket1 â”‚  â”‚ Bucket2 â”‚  â”‚ Bucket3 â”‚  â”‚ Bucket4 â”‚  â”‚ Bucket5 â”‚   â”‚  â”‚
â”‚   â”‚  â”‚  ğŸ“„ğŸ“„ğŸ“„  â”‚  â”‚  ğŸ“„ğŸ“„ğŸ“„  â”‚  â”‚  ğŸ“„ğŸ“„ğŸ“„  â”‚  â”‚  ğŸ“„ğŸ“„ğŸ“„  â”‚  â”‚  ğŸ“„ğŸ“„ğŸ“„  â”‚   â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                         Amazon Macie                                 â”‚  â”‚
â”‚   â”‚                                                                      â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚   â”‚  â”‚  Data Discovery â”‚  â”‚  ML Detection   â”‚  â”‚  Pattern Matching   â”‚  â”‚  â”‚
â”‚   â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚                     â”‚  â”‚  â”‚
â”‚   â”‚  â”‚ â€¢ Inventory     â”‚  â”‚ â€¢ Credentials   â”‚  â”‚ â€¢ PII (SSN, CC)     â”‚  â”‚  â”‚
â”‚   â”‚  â”‚ â€¢ Classificationâ”‚  â”‚ â€¢ Custom data   â”‚  â”‚ â€¢ PHI (Health)      â”‚  â”‚  â”‚
â”‚   â”‚  â”‚ â€¢ Sampling      â”‚  â”‚ â€¢ Anomalies     â”‚  â”‚ â€¢ Financial data    â”‚  â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚                                        â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚                    â–¼                               â–¼                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚     Sensitive Data         â”‚    â”‚    Security Findings       â”‚         â”‚
â”‚   â”‚     Findings               â”‚    â”‚                            â”‚         â”‚
â”‚   â”‚                            â”‚    â”‚ â€¢ Public buckets           â”‚         â”‚
â”‚   â”‚ â€¢ PII discovered           â”‚    â”‚ â€¢ Unencrypted data         â”‚         â”‚
â”‚   â”‚ â€¢ Location in S3           â”‚    â”‚ â€¢ Policy issues            â”‚         â”‚
â”‚   â”‚ â€¢ Data samples             â”‚    â”‚ â€¢ Access anomalies         â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## What is Amazon Macie?

### Key Capabilities

| Capability | Description |
|------------|-------------|
| **S3 Inventory** | Automatic discovery and evaluation of all S3 buckets |
| **Sensitive Data Discovery** | Find PII, PHI, financial data, and credentials |
| **Custom Data Identifiers** | Define custom patterns for business-specific data |
| **Security Monitoring** | Detect public buckets, unencrypted data, shared access |
| **Automated Scanning** | Schedule recurring discovery jobs |
| **Multi-Account** | Centralized management via AWS Organizations |
| **Integration** | EventBridge, Security Hub, and S3 for findings |

### Macie Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Macie Architecture                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   Administrator Account                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                    Macie Administrator                               â”‚  â”‚
â”‚   â”‚                                                                      â”‚  â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚   â”‚   â”‚              Central Management Console                    â”‚    â”‚  â”‚
â”‚   â”‚   â”‚                                                            â”‚    â”‚  â”‚
â”‚   â”‚   â”‚  â€¢ Aggregated findings from all accounts                   â”‚    â”‚  â”‚
â”‚   â”‚   â”‚  â€¢ Organization-wide statistics                            â”‚    â”‚  â”‚
â”‚   â”‚   â”‚  â€¢ Custom data identifier management                       â”‚    â”‚  â”‚
â”‚   â”‚   â”‚  â€¢ Discovery job scheduling                                â”‚    â”‚  â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚                                        â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚          â–¼                         â–¼                         â–¼             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ Member Acct1 â”‚          â”‚ Member Acct2 â”‚          â”‚ Member AcctN â”‚    â”‚
â”‚   â”‚              â”‚          â”‚              â”‚          â”‚              â”‚    â”‚
â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚          â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚          â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
â”‚   â”‚ â”‚S3 Bucketsâ”‚ â”‚          â”‚ â”‚S3 Bucketsâ”‚ â”‚          â”‚ â”‚S3 Bucketsâ”‚ â”‚    â”‚
â”‚   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚
â”‚   â”‚      â”‚       â”‚          â”‚      â”‚       â”‚          â”‚      â”‚       â”‚    â”‚
â”‚   â”‚      â–¼       â”‚          â”‚      â–¼       â”‚          â”‚      â–¼       â”‚    â”‚
â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚          â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚          â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
â”‚   â”‚ â”‚ Findings â”‚â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”‚ Findings â”‚â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”‚ Findings â”‚ â”‚    â”‚
â”‚   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Sensitive Data Discovery

### Built-in Managed Data Identifiers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Managed Data Identifiers                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Personal Identifiable Information (PII)                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ Name                          â€¢ Driver's License Number          â”‚   â”‚
â”‚  â”‚  â€¢ Address                       â€¢ Passport Number                  â”‚   â”‚
â”‚  â”‚  â€¢ Email Address                 â€¢ National ID (SSN, SIN, etc.)     â”‚   â”‚
â”‚  â”‚  â€¢ Phone Number                  â€¢ Date of Birth                    â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Taxpayer ID                  â€¢ Vehicle ID (VIN)               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  Financial Information                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ Credit Card Number            â€¢ Bank Account Number              â”‚   â”‚
â”‚  â”‚  â€¢ Credit Card CVV               â€¢ Bank Routing Number              â”‚   â”‚
â”‚  â”‚  â€¢ Credit Card Expiry            â€¢ SWIFT Code                       â”‚   â”‚
â”‚  â”‚  â€¢ Magnetic Stripe Data          â€¢ IBAN                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  Protected Health Information (PHI)                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ Health Insurance ID           â€¢ Medical Record Number            â”‚   â”‚
â”‚  â”‚  â€¢ Drug Enforcement Admin Number â€¢ Healthcare Provider ID           â”‚   â”‚
â”‚  â”‚  â€¢ Medical Terms                                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  Credentials and Secrets                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ AWS Secret Access Key         â€¢ HTTP Basic Auth Header           â”‚   â”‚
â”‚  â”‚  â€¢ AWS Access Key ID             â€¢ JSON Web Token (JWT)             â”‚   â”‚
â”‚  â”‚  â€¢ OpenSSH Private Key           â€¢ PGP Private Key                  â”‚   â”‚
â”‚  â”‚  â€¢ Generic API Key               â€¢ RSA Private Key                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Sensitive Data Finding Types

| Finding Type | Description |
|--------------|-------------|
| **SensitiveData:S3Object/Multiple** | Multiple types of sensitive data found |
| **SensitiveData:S3Object/Personal** | Personal information detected |
| **SensitiveData:S3Object/Financial** | Financial data detected |
| **SensitiveData:S3Object/Credentials** | Credentials or secrets found |
| **SensitiveData:S3Object/CustomIdentifier** | Custom pattern matched |

## S3 Bucket Analysis

### Security Findings

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      S3 Security Finding Types                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Policy-Based Findings                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Policy:IAMUser/S3BucketPublic                                      â”‚   â”‚
â”‚  â”‚  â€¢ Bucket policy allows public access                               â”‚   â”‚
â”‚  â”‚  â€¢ ACL grants public access                                         â”‚   â”‚
â”‚  â”‚  â€¢ Block public access settings disabled                            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Policy:IAMUser/S3BucketSharedExternally                            â”‚   â”‚
â”‚  â”‚  â€¢ Bucket shared with external AWS accounts                         â”‚   â”‚
â”‚  â”‚  â€¢ Cross-account access detected                                    â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Policy:IAMUser/S3BucketReplicatedExternally                        â”‚   â”‚
â”‚  â”‚  â€¢ Bucket replication to external account                           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Policy:IAMUser/S3BlockPublicAccessDisabled                         â”‚   â”‚
â”‚  â”‚  â€¢ Account-level block public access disabled                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  Encryption Findings                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â€¢ Bucket without default encryption                                â”‚   â”‚
â”‚  â”‚  â€¢ Objects using SSE-S3 instead of SSE-KMS                          â”‚   â”‚
â”‚  â”‚  â€¢ Missing encryption in transit enforcement                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  Access Control Findings                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â€¢ Overly permissive bucket policies                                â”‚   â”‚
â”‚  â”‚  â€¢ Unused access grants                                             â”‚   â”‚
â”‚  â”‚  â€¢ Misconfigured bucket ACLs                                        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Bucket Inventory Dashboard

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Macie S3 Bucket Inventory                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Summary Statistics                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Total Buckets: 156        â”‚  Objects: 2.3M  â”‚  Storage: 4.5 TB     â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚   â”‚
â”‚  â”‚  â”‚ Public: 3    â”‚  â”‚ Encrypted:   â”‚  â”‚ Shared:      â”‚              â”‚   â”‚
â”‚  â”‚  â”‚ âš ï¸ Warning   â”‚  â”‚ 142 (91%)    â”‚  â”‚ 12 accounts  â”‚              â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  Bucket Details                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Bucket Name          â”‚ Public â”‚ Encrypted â”‚ Sensitive â”‚ Last Scan â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   â”‚
â”‚  â”‚  prod-customer-data   â”‚   No   â”‚    Yes    â”‚    Yes    â”‚ 2 hrs ago â”‚   â”‚
â”‚  â”‚  logs-archive         â”‚   No   â”‚    Yes    â”‚    No     â”‚ 1 day ago â”‚   â”‚
â”‚  â”‚  public-assets        â”‚  Yes   â”‚    No     â”‚    No     â”‚ 3 hrs ago â”‚   â”‚
â”‚  â”‚  backup-database      â”‚   No   â”‚    Yes    â”‚    Yes    â”‚ 6 hrs ago â”‚   â”‚
â”‚  â”‚  temp-uploads         â”‚  Yes   â”‚    No     â”‚    Yes    â”‚ 1 hr ago  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Custom Data Identifiers

### Creating Custom Identifiers

Custom data identifiers allow you to define patterns for business-specific sensitive data using regular expressions and keywords.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Custom Data Identifier Structure                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  Name: Employee-ID-Pattern                                          â”‚  â”‚
â”‚   â”‚  Description: Matches company employee ID format                    â”‚  â”‚
â”‚   â”‚                                                                     â”‚  â”‚
â”‚   â”‚  Regular Expression:                                                â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚  â”‚
â”‚   â”‚  â”‚  EMP-[A-Z]{2}-[0-9]{6}                                    â”‚     â”‚  â”‚
â”‚   â”‚  â”‚                                                           â”‚     â”‚  â”‚
â”‚   â”‚  â”‚  Matches: EMP-US-123456, EMP-UK-987654                    â”‚     â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚
â”‚   â”‚                                                                     â”‚  â”‚
â”‚   â”‚  Keywords (proximity-based):                                        â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚  â”‚
â”‚   â”‚  â”‚  employee, worker, staff, personnel, id, identifier       â”‚     â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚
â”‚   â”‚                                                                     â”‚  â”‚
â”‚   â”‚  Maximum Match Distance: 50 characters                              â”‚  â”‚
â”‚   â”‚                                                                     â”‚  â”‚
â”‚   â”‚  Ignore Words:                                                      â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚  â”‚
â”‚   â”‚  â”‚  test, example, sample, demo                              â”‚     â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚
â”‚   â”‚                                                                     â”‚  â”‚
â”‚   â”‚  Severity: HIGH                                                     â”‚  â”‚
â”‚   â”‚                                                                     â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### CLI Examples for Custom Identifiers

```bash
# Create custom data identifier for employee IDs
aws macie2 create-custom-data-identifier \
    --name "EmployeeID" \
    --description "Company employee ID format" \
    --regex "EMP-[A-Z]{2}-[0-9]{6}" \
    --keywords '["employee", "worker", "staff", "personnel"]' \
    --maximum-match-distance 50 \
    --ignore-words '["test", "example", "sample"]' \
    --severity-levels '[{"occurrencesThreshold": 1, "severity": "HIGH"}]'

# Create custom identifier for project codes
aws macie2 create-custom-data-identifier \
    --name "ProjectCode" \
    --description "Internal project code format" \
    --regex "PRJ-[0-9]{4}-[A-Z]{3}" \
    --keywords '["project", "initiative", "program"]' \
    --maximum-match-distance 30

# Create custom identifier for internal account numbers
aws macie2 create-custom-data-identifier \
    --name "InternalAccountNumber" \
    --description "Internal account numbering system" \
    --regex "ACCT[0-9]{10}" \
    --keywords '["account", "customer", "client"]' \
    --severity-levels '[
        {"occurrencesThreshold": 1, "severity": "MEDIUM"},
        {"occurrencesThreshold": 10, "severity": "HIGH"}
    ]'

# List all custom data identifiers
aws macie2 list-custom-data-identifiers

# Get details of specific identifier
aws macie2 get-custom-data-identifier \
    --id "custom-data-identifier-id"

# Test custom identifier with sample data
aws macie2 test-custom-data-identifier \
    --regex "EMP-[A-Z]{2}-[0-9]{6}" \
    --sample-text "Employee John Smith has ID EMP-US-123456 and works in department XYZ"
```

### Common Custom Identifier Patterns

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Common Custom Data Identifier Examples                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Healthcare                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Name: MRN (Medical Record Number)                                  â”‚   â”‚
â”‚  â”‚  Regex: MRN[0-9]{8}                                                 â”‚   â”‚
â”‚  â”‚  Keywords: patient, medical, record, chart                          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Name: NPI (National Provider Identifier)                           â”‚   â”‚
â”‚  â”‚  Regex: [0-9]{10}                                                   â”‚   â”‚
â”‚  â”‚  Keywords: provider, physician, NPI, practitioner                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  Finance                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Name: Internal Trading ID                                          â”‚   â”‚
â”‚  â”‚  Regex: TRD-[A-Z]{3}-[0-9]{8}                                       â”‚   â”‚
â”‚  â”‚  Keywords: trade, transaction, order                                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Name: Loan Application Number                                      â”‚   â”‚
â”‚  â”‚  Regex: LOAN-[0-9]{4}-[0-9]{6}                                      â”‚   â”‚
â”‚  â”‚  Keywords: loan, application, mortgage, credit                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  Retail/E-commerce                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Name: Customer Loyalty ID                                          â”‚   â”‚
â”‚  â”‚  Regex: LOYAL-[A-Z0-9]{12}                                          â”‚   â”‚
â”‚  â”‚  Keywords: loyalty, member, rewards, customer                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Name: Order Reference                                              â”‚   â”‚
â”‚  â”‚  Regex: ORD-[0-9]{4}-[A-Z]{2}-[0-9]{6}                              â”‚   â”‚
â”‚  â”‚  Keywords: order, purchase, transaction                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  Manufacturing                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Name: Serial Number                                                â”‚   â”‚
â”‚  â”‚  Regex: SN[A-Z]{2}[0-9]{8}                                          â”‚   â”‚
â”‚  â”‚  Keywords: serial, product, unit, device                            â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  Name: Batch/Lot Number                                             â”‚   â”‚
â”‚  â”‚  Regex: LOT-[0-9]{4}-[0-9]{2}-[0-9]{4}                              â”‚   â”‚
â”‚  â”‚  Keywords: batch, lot, production, manufacturing                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Enabling and Configuring Macie

### Enable Macie via Console

1. Navigate to Amazon Macie console
2. Click "Get started"
3. Review service-linked role creation
4. Enable Macie
5. Configure S3 bucket inventory
6. Set up discovery jobs

### Enable Macie via CLI

```bash
# Enable Macie for the account
aws macie2 enable-macie

# Check Macie status
aws macie2 get-macie-session

# Enable organization administrator (if using Organizations)
aws macie2 enable-organization-admin-account \
    --admin-account-id 123456789012

# Update Macie configuration
aws macie2 update-macie-session \
    --finding-publishing-frequency FIFTEEN_MINUTES \
    --status ENABLED
```

### Create Discovery Job

```bash
# Create a one-time discovery job
aws macie2 create-classification-job \
    --name "PII-Discovery-Job" \
    --description "Scan for PII in customer data buckets" \
    --job-type ONE_TIME \
    --s3-job-definition '{
        "bucketDefinitions": [
            {
                "accountId": "123456789012",
                "buckets": ["customer-data-bucket", "user-uploads-bucket"]
            }
        ],
        "scoping": {
            "includes": {
                "and": [
                    {
                        "simpleScopeTerm": {
                            "comparator": "STARTS_WITH",
                            "key": "OBJECT_KEY",
                            "values": ["data/", "uploads/"]
                        }
                    }
                ]
            },
            "excludes": {
                "and": [
                    {
                        "simpleScopeTerm": {
                            "comparator": "STARTS_WITH",
                            "key": "OBJECT_KEY",
                            "values": ["logs/", "temp/"]
                        }
                    }
                ]
            }
        }
    }' \
    --managed-data-identifier-selector ALL \
    --sampling-percentage 100

# Create a scheduled discovery job
aws macie2 create-classification-job \
    --name "Weekly-PII-Scan" \
    --description "Weekly scan of all S3 buckets" \
    --job-type SCHEDULED \
    --schedule-frequency '{
        "dailySchedule": {},
        "weeklySchedule": {"dayOfWeek": "SUNDAY"}
    }' \
    --s3-job-definition '{
        "bucketCriteria": {
            "includes": {
                "and": [
                    {
                        "simpleCriterion": {
                            "comparator": "EQ",
                            "key": "ACCOUNT_ID",
                            "values": ["123456789012"]
                        }
                    }
                ]
            }
        }
    }' \
    --initial-run true
```

### CloudFormation Template

```yaml
AWSTemplateFormatVersion: '2010-09-09'
Description: 'Amazon Macie Configuration'

Parameters:
  AdminEmail:
    Type: String
    Description: 'Email for Macie alerts'

Resources:
  # Enable Macie
  MacieSession:
    Type: AWS::Macie::Session
    Properties:
      FindingPublishingFrequency: FIFTEEN_MINUTES
      Status: ENABLED

  # Custom Data Identifier
  EmployeeIDIdentifier:
    Type: AWS::Macie::CustomDataIdentifier
    DependsOn: MacieSession
    Properties:
      Name: 'EmployeeID'
      Description: 'Company employee ID format'
      Regex: 'EMP-[A-Z]{2}-[0-9]{6}'
      Keywords:
        - employee
        - worker
        - staff

  # Allow List for known test data
  TestDataAllowList:
    Type: AWS::Macie::AllowList
    DependsOn: MacieSession
    Properties:
      Name: 'TestDataAllowList'
      Description: 'Known test data patterns to ignore'
      Criteria:
        Regex: 'TEST-[0-9]{6}'

  # SNS Topic for Macie findings
  MacieAlertTopic:
    Type: AWS::SNS::Topic
    Properties:
      TopicName: 'macie-sensitive-data-alerts'
      KmsMasterKeyId: alias/aws/sns

  MacieAlertSubscription:
    Type: AWS::SNS::Subscription
    Properties:
      TopicArn: !Ref MacieAlertTopic
      Protocol: email
      Endpoint: !Ref AdminEmail

  # EventBridge rule for high-severity findings
  MacieFindingsRule:
    Type: AWS::Events::Rule
    Properties:
      Name: 'MacieHighSeverityFindings'
      Description: 'Alert on high severity Macie findings'
      EventPattern:
        source:
          - aws.macie
        detail-type:
          - Macie Finding
        detail:
          severity:
            description:
              - High
              - Critical
      State: ENABLED
      Targets:
        - Id: SNSTarget
          Arn: !Ref MacieAlertTopic

  # S3 bucket for Macie discovery results
  MacieResultsBucket:
    Type: AWS::S3::Bucket
    Properties:
      BucketName: !Sub 'macie-results-${AWS::AccountId}'
      BucketEncryption:
        ServerSideEncryptionConfiguration:
          - ServerSideEncryptionByDefault:
              SSEAlgorithm: aws:kms
              KMSMasterKeyID: alias/aws/s3
      PublicAccessBlockConfiguration:
        BlockPublicAcls: true
        BlockPublicPolicy: true
        IgnorePublicAcls: true
        RestrictPublicBuckets: true
      VersioningConfiguration:
        Status: Enabled

  MacieResultsBucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket: !Ref MacieResultsBucket
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Sid: AllowMacieToWriteResults
            Effect: Allow
            Principal:
              Service: macie.amazonaws.com
            Action:
              - s3:PutObject
              - s3:PutObjectAcl
            Resource: !Sub '${MacieResultsBucket.Arn}/*'
            Condition:
              StringEquals:
                aws:SourceAccount: !Ref AWS::AccountId

Outputs:
  MacieResultsBucketName:
    Description: 'S3 bucket for Macie results'
    Value: !Ref MacieResultsBucket

  AlertTopicArn:
    Description: 'SNS topic for Macie alerts'
    Value: !Ref MacieAlertTopic
```

## Hands-on Example

### Complete Macie Setup and Scan

```bash
#!/bin/bash
# Complete Macie setup and scanning workflow

set -e

ACCOUNT_ID=$(aws sts get-caller-identity --query Account --output text)
REGION="us-east-1"

echo "Step 1: Enable Macie"
aws macie2 enable-macie --region $REGION || echo "Macie may already be enabled"

echo "Step 2: Wait for Macie to be ready"
sleep 10

echo "Step 3: Check Macie status"
aws macie2 get-macie-session --region $REGION

echo "Step 4: Create custom data identifiers"

# Employee ID identifier
aws macie2 create-custom-data-identifier \
    --name "EmployeeID" \
    --description "Company employee ID format" \
    --regex "EMP-[A-Z]{2}-[0-9]{6}" \
    --keywords '["employee", "worker", "staff"]' \
    --region $REGION || echo "Identifier may already exist"

# Project code identifier
aws macie2 create-custom-data-identifier \
    --name "ProjectCode" \
    --description "Internal project code format" \
    --regex "PRJ-[0-9]{4}-[A-Z]{3}" \
    --keywords '["project", "initiative"]' \
    --region $REGION || echo "Identifier may already exist"

echo "Step 5: Get bucket inventory"
aws macie2 describe-buckets \
    --region $REGION \
    --query 'buckets[].{Name:bucketName,Public:publicAccess.effectivePermission,Encrypted:serverSideEncryption.type}' \
    --output table

echo "Step 6: Create discovery job"
# Get custom identifier IDs
CUSTOM_IDS=$(aws macie2 list-custom-data-identifiers \
    --region $REGION \
    --query 'items[].id' \
    --output json)

# Create job
JOB_ID=$(aws macie2 create-classification-job \
    --name "Full-Bucket-Scan-$(date +%Y%m%d)" \
    --description "Full scan of all buckets" \
    --job-type ONE_TIME \
    --s3-job-definition "{
        \"bucketCriteria\": {
            \"includes\": {
                \"and\": [
                    {
                        \"simpleCriterion\": {
                            \"comparator\": \"EQ\",
                            \"key\": \"ACCOUNT_ID\",
                            \"values\": [\"$ACCOUNT_ID\"]
                        }
                    }
                ]
            },
            \"excludes\": {
                \"and\": [
                    {
                        \"simpleCriterion\": {
                            \"comparator\": \"STARTS_WITH\",
                            \"key\": \"BUCKET_NAME\",
                            \"values\": [\"aws-\", \"cloudtrail-\"]
                        }
                    }
                ]
            }
        }
    }" \
    --managed-data-identifier-selector ALL \
    --custom-data-identifier-ids $CUSTOM_IDS \
    --sampling-percentage 100 \
    --region $REGION \
    --query 'jobId' --output text)

echo "Created job: $JOB_ID"

echo "Step 7: Monitor job status"
while true; do
    STATUS=$(aws macie2 describe-classification-job \
        --job-id $JOB_ID \
        --region $REGION \
        --query 'jobStatus' --output text)

    echo "Job status: $STATUS"

    if [ "$STATUS" == "COMPLETE" ] || [ "$STATUS" == "CANCELLED" ] || [ "$STATUS" == "PAUSED" ]; then
        break
    fi

    sleep 30
done

echo "Step 8: Get findings"
aws macie2 get-findings \
    --region $REGION \
    --finding-ids $(aws macie2 list-findings \
        --region $REGION \
        --query 'findingIds[0:5]' --output text) \
    --query 'findings[].{Type:type,Severity:severity.description,Bucket:resourcesAffected.s3Bucket.name}' \
    --output table

echo "Step 9: Get findings summary"
aws macie2 get-finding-statistics \
    --region $REGION \
    --group-by SEVERITY_DESCRIPTION \
    --query 'countsByGroup[].{Severity:groupKey,Count:count}' \
    --output table
```

### Analyzing Findings

```bash
#!/bin/bash
# Analyze Macie findings

REGION="us-east-1"

echo "=== Macie Findings Analysis ==="

echo -e "\n1. Findings by Severity:"
aws macie2 get-finding-statistics \
    --group-by SEVERITY_DESCRIPTION \
    --region $REGION

echo -e "\n2. Findings by Type:"
aws macie2 get-finding-statistics \
    --group-by TYPE \
    --region $REGION

echo -e "\n3. Findings by Bucket:"
aws macie2 get-finding-statistics \
    --group-by RESOURCE_AFFECTED \
    --region $REGION

echo -e "\n4. Get detailed findings:"
# Get finding IDs
FINDING_IDS=$(aws macie2 list-findings \
    --sort-criteria '{"attributeName": "severity.score", "orderBy": "DESC"}' \
    --max-results 10 \
    --region $REGION \
    --query 'findingIds' --output json)

if [ "$FINDING_IDS" != "[]" ]; then
    aws macie2 get-findings \
        --finding-ids $FINDING_IDS \
        --region $REGION \
        --query 'findings[].{
            Type:type,
            Severity:severity.description,
            Bucket:resourcesAffected.s3Bucket.name,
            Object:resourcesAffected.s3Object.key,
            SensitiveData:classificationDetails.detailedResultsLocation
        }' \
        --output table
fi

echo -e "\n5. Bucket security summary:"
aws macie2 describe-buckets \
    --region $REGION \
    --query 'buckets[?publicAccess.effectivePermission!=`NOT_PUBLIC`].{
        Name:bucketName,
        Access:publicAccess.effectivePermission,
        Encryption:serverSideEncryption.type
    }' \
    --output table
```

### Exporting and Archiving Findings

```bash
#!/bin/bash
# Export Macie findings

REGION="us-east-1"
EXPORT_BUCKET="macie-exports-$(aws sts get-caller-identity --query Account --output text)"

# Create export bucket if it doesn't exist
aws s3 mb s3://$EXPORT_BUCKET --region $REGION 2>/dev/null || true

# Enable encryption on bucket
aws s3api put-bucket-encryption \
    --bucket $EXPORT_BUCKET \
    --server-side-encryption-configuration '{
        "Rules": [{
            "ApplyServerSideEncryptionByDefault": {
                "SSEAlgorithm": "aws:kms"
            }
        }]
    }'

# Configure Macie to export findings
aws macie2 put-classification-export-configuration \
    --configuration "{
        \"s3Destination\": {
            \"bucketName\": \"$EXPORT_BUCKET\",
            \"keyPrefix\": \"macie-findings/\",
            \"kmsKeyArn\": \"arn:aws:kms:$REGION:$(aws sts get-caller-identity --query Account --output text):alias/aws/s3\"
        }
    }" \
    --region $REGION

echo "Findings will be exported to s3://$EXPORT_BUCKET/macie-findings/"

# Verify configuration
aws macie2 get-classification-export-configuration --region $REGION
```

## Integration Patterns

### Security Hub Integration

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Macie + Security Hub Integration                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                       â”‚
â”‚   â”‚     Macie       â”‚                                                       â”‚
â”‚   â”‚                 â”‚                                                       â”‚
â”‚   â”‚ â€¢ PII Findings  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ â€¢ Policy Issues â”‚              â”‚          Security Hub            â”‚    â”‚
â”‚   â”‚ â€¢ Custom Data   â”‚              â”‚                                  â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚                                    â”‚  â”‚   Unified Findings View    â”‚  â”‚    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚  â”‚                            â”‚  â”‚    â”‚
â”‚   â”‚   GuardDuty     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  â”‚  â€¢ Macie Findings          â”‚  â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚  â”‚  â€¢ GuardDuty Findings      â”‚  â”‚    â”‚
â”‚                                    â”‚  â”‚  â€¢ Inspector Findings      â”‚  â”‚    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚  â”‚  â€¢ Config Findings         â”‚  â”‚    â”‚
â”‚   â”‚   Inspector     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  â”‚                            â”‚  â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚                                    â”‚              â”‚                   â”‚    â”‚
â”‚                                    â”‚              â–¼                   â”‚    â”‚
â”‚                                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚                                    â”‚  â”‚    Automated Response      â”‚  â”‚    â”‚
â”‚                                    â”‚  â”‚    (EventBridge + Lambda)  â”‚  â”‚    â”‚
â”‚                                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Automated Response Pattern

```python
# Lambda function for automated response to Macie findings
import boto3
import json
import logging

logger = logging.getLogger()
logger.setLevel(logging.INFO)

s3 = boto3.client('s3')
sns = boto3.client('sns')
macie = boto3.client('macie2')

def lambda_handler(event, context):
    """
    Automated response to Macie sensitive data findings
    """
    finding = event['detail']

    finding_type = finding.get('type', '')
    severity = finding.get('severity', {}).get('description', 'Unknown')
    bucket_name = finding.get('resourcesAffected', {}).get('s3Bucket', {}).get('name', '')
    object_key = finding.get('resourcesAffected', {}).get('s3Object', {}).get('key', '')

    logger.info(f"Processing finding: {finding_type} in {bucket_name}/{object_key}")

    actions_taken = []

    # High severity: Quarantine the object
    if severity in ['High', 'Critical']:
        if bucket_name and object_key:
            # Move to quarantine bucket
            quarantine_bucket = f"quarantine-{bucket_name}"

            try:
                # Copy to quarantine
                s3.copy_object(
                    Bucket=quarantine_bucket,
                    Key=f"quarantine/{object_key}",
                    CopySource={'Bucket': bucket_name, 'Key': object_key}
                )

                # Delete original
                s3.delete_object(Bucket=bucket_name, Key=object_key)

                actions_taken.append(f"Quarantined {bucket_name}/{object_key}")
                logger.info(f"Quarantined {bucket_name}/{object_key}")

            except Exception as e:
                logger.error(f"Failed to quarantine: {str(e)}")
                actions_taken.append(f"Failed to quarantine: {str(e)}")

    # If public bucket with sensitive data, block public access
    if 'Policy:IAMUser/S3BucketPublic' in finding_type:
        try:
            s3.put_public_access_block(
                Bucket=bucket_name,
                PublicAccessBlockConfiguration={
                    'BlockPublicAcls': True,
                    'IgnorePublicAcls': True,
                    'BlockPublicPolicy': True,
                    'RestrictPublicBuckets': True
                }
            )
            actions_taken.append(f"Blocked public access on {bucket_name}")
            logger.info(f"Blocked public access on {bucket_name}")

        except Exception as e:
            logger.error(f"Failed to block public access: {str(e)}")

    # Send notification
    notification = {
        'FindingType': finding_type,
        'Severity': severity,
        'Bucket': bucket_name,
        'Object': object_key,
        'ActionsTaken': actions_taken
    }

    sns.publish(
        TopicArn=os.environ['SNS_TOPIC_ARN'],
        Subject=f"Macie Alert: {severity} severity finding",
        Message=json.dumps(notification, indent=2)
    )

    return {
        'statusCode': 200,
        'body': json.dumps({
            'message': 'Finding processed',
            'actions': actions_taken
        })
    }
```

## Best Practices

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Macie Best Practices                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  1. Discovery Job Configuration                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ Start with sampling to estimate costs                             â”‚   â”‚
â”‚  â”‚  â€¢ Use scoping to exclude logs and non-data buckets                  â”‚   â”‚
â”‚  â”‚  â€¢ Schedule regular scans for ongoing monitoring                     â”‚   â”‚
â”‚  â”‚  â€¢ Include custom identifiers for business data                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  2. Finding Management                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ Create allow lists for known safe patterns                        â”‚   â”‚
â”‚  â”‚  â€¢ Suppress findings for intentionally public buckets                â”‚   â”‚
â”‚  â”‚  â€¢ Set up tiered alerting based on severity                          â”‚   â”‚
â”‚  â”‚  â€¢ Export findings to S3 for long-term retention                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  3. Cost Optimization                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ Use sampling for large buckets (10-50%)                           â”‚   â”‚
â”‚  â”‚  â€¢ Exclude static content and logs from scans                        â”‚   â”‚
â”‚  â”‚  â€¢ Schedule scans during off-peak hours                              â”‚   â”‚
â”‚  â”‚  â€¢ Monitor usage with CloudWatch metrics                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  4. Multi-Account Strategy                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ Designate a delegated administrator account                       â”‚   â”‚
â”‚  â”‚  â€¢ Use organization-level custom identifiers                         â”‚   â”‚
â”‚  â”‚  â€¢ Aggregate findings in central security account                    â”‚   â”‚
â”‚  â”‚  â€¢ Implement consistent tagging across accounts                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  5. Compliance Alignment                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Regulation       â”‚  Relevant Data Types                             â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚   â”‚
â”‚  â”‚  PCI-DSS          â”‚  Credit card numbers, CVV, track data           â”‚   â”‚
â”‚  â”‚  HIPAA            â”‚  PHI, medical records, insurance IDs            â”‚   â”‚
â”‚  â”‚  GDPR             â”‚  PII, names, addresses, email, phone            â”‚   â”‚
â”‚  â”‚  SOX              â”‚  Financial data, audit trails                   â”‚   â”‚
â”‚  â”‚  CCPA             â”‚  California resident PII                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Pricing

| Component | Pricing |
|-----------|---------|
| **S3 bucket evaluation** | Free (included) |
| **Sensitive data discovery** | $1.00 per GB scanned (first 50 TB/month) |
| | $0.50 per GB (50 TB - 500 TB/month) |
| | $0.25 per GB (over 500 TB/month) |

**Cost Estimation Example**:
- 100 GB of data scanned: 100 GB x $1.00 = $100/month
- With 20% sampling: 20 GB x $1.00 = $20/month

## Summary

Amazon Macie provides comprehensive data security for S3:

1. **Automatic Discovery**: Continuous inventory and security evaluation of S3 buckets
2. **Sensitive Data Detection**: ML-powered detection of PII, PHI, financial data, and credentials
3. **Custom Identifiers**: Define patterns for business-specific sensitive data
4. **Security Monitoring**: Detect public buckets, unencrypted data, and policy issues
5. **Integration**: Native support for Security Hub and EventBridge

**Key Takeaways**:
- Enable Macie for all accounts containing sensitive data
- Create custom identifiers for business-specific data patterns
- Use sampling to control costs while maintaining coverage
- Implement automated response for high-severity findings
- Regularly review and tune suppression rules and allow lists
